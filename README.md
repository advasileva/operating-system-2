# Операционные системы ИДЗ 2

0. [**Задание**](#задание)
0. [**Отчёт**](#отчёт)
    + [*4 балла*](#4-балла)
    + [*5 баллов*](#5-баллов)
    + [*6 баллов*](#6-баллов)
0. [**Как запустить**](#как-запустить)

## Задание

*Применение семафоров для организации взаимодействия параллельных процессов.*

*Вариант 20. Задача о магазине – 2 (забывчивые покупатели). В магазине работают два отдела, каждый отдел обладает уникальным ассортиментом. В каждом отделе работает один продавец. В магазин ходят исключительно забывчивые покупатели, поэтому каждый покупатель носит с собой список товаров, которые желает купить. Покупатель приобретает товары точно в том порядке, в каком они записаны в его списке. При этом товары в списке расположены в случайном порядке, что заставляет покупателя переходить от отдела к отделу, если это требуется для совершения покупок. Продавец может обслужить только одного покупателя за раз. Покупатель, вставший в очередь, засыпает пока не дойдет до продавца. Продавец засыпает, если в его отделе нет покупателей, и просыпается, если появится хотя бы один. Создать приложение, моделирующее работу магазина в течение рабочего дня. Каждого продавца и покупателя представить отдельным процессом*

## Отчёт

**Исполнитель: Васильева Алёна Дмитриевна БПИ218**

**Делала на оценку 6 баллов**

### 4 балла 
### Именнованные POSIX семафоры

*Разработать консольное приложение, в котором единый родительский процесс запускает требуемое число дочерних процессов.*

1. *В отчете приведены фамилия, имя, отчество исполнителя, группа.*

    Продублирую: Васильева Алёна Дмитриевна БПИ218

2. *Приведено условие задачи.*

    [Условие](#задание)

3. *Представить сценарий решаемой задачи поясняющий, каким образом исходные сущности и их поведение отображаются в процессы и их взаимодействие.*

    Задача описана достаточно подробно. У нас есть 5 сущностей -- продавец, покупатель, товар, ассортимент, список.
    
    Продавец и покупатель будут представлены процессами (два процесса для двух продавцов и `n` процессов для покупателей в зависимости от теста). Товар будет представлен числовым идентификатором типа int. Ассортимент продавца и список покупателя будут представлены массивами из идентификаторов (товаров). 

    Процессы продавцов и покупателей будут взаимодействовать между собой через разделяемую память посредством семафоров. Каждый продавец будет иметь ассортимент и каждый покупатель будет иметь список. В ассортиментах и списках будут встречаться идентификаторы товаров не более `m`.

4. *Множество процессов взаимодействуют с использованием именованных POSIX семафоров. Обмен данными ведется через разделяемую память в стандарте POSIX.*

    Разработанная программа находится в файле `4-points/main.c`

5. *Реализовать завершение программы в соответствии с условием задачи, а также предусмотреть корректное завершение по прерыванию с клавиатуры по соответствующему сигналу.*

    По умолчанию программа завершается после завершения работы покупателей. Также можно прервать программу, например, с помощью `Ctrl+C`.

6. *В программе предусмотреть удаление семафоров и разделяемой памяти по ее завершению любым из способов.*

    Завершенение работы реализовано так:
    ```c
    shm_unlink(memn);

    sem_close(sem_first);
    sem_close(sem_second);
    ```

7. *Результаты работы программы должны быть отражены в отчете.*

    Пример работы:
    ```bash
    Test 1
    Seller PID: 72210
    Seller PID: 72211
    Buyer PID: 72212
    Buying stock from 1
    Selling stock by 1
    Buying stock from 2
    Selling stock by 2
    Buying stock from 1
    Selling stock by 1
    Buying stock from 2
    Buying stock from 1
    Selling stock by 2
    Selling stock by 1
    Seller 2 finished

    Test 2
    Seller PID: 72225
    Seller PID: 72226
    Buyer PID: 72227
    Buying stock from 1
    Seller 1 finished
    Buying stock from 2
    Selling stock by 1
    Buying stock from 1
    Selling stock by 2
    Selling stock by 1
    Buying stock from 2
    Selling stock by 2
    Buying stock from 1
    Selling stock by 1
    Seller 2 finished

    Test 3
    Seller PID: 72235
    Seller PID: 72236
    Buyer PID: 72237
    Buying stock from 1
    Seller 1 finished
    Selling stock by 1
    Buying stock from 2
    Selling stock by 2
    Buying stock from 1
    Selling stock by 1
    Buying stock from 2
    Selling stock by 2
    Buying stock from 1
    Selling stock by 1
    ```

### 5 баллов
### Неименнованные POSIX семафоры

*В дополнение к программе на предыдущую оценку необходимо разработать программу, в которой для взаимодействия процессов используется один из двух вариантов, описанных выше, но не реализованных на предшествующую оценку.*

1. *Множество процессов взаимодействуют с использованием неименованных POSIX семафоров расположенных в разделяемой памяти. Обмен данными также ведется через разделяемую память в стандарте POSIX.*

    TBA

2. *Реализовать завершение программы в соответствии с условием задачи, а также предусмотреть корректное завершение по прерыванию с клавиатуры по соответствующему сигналу.*

    TBA

3. *В программе предусмотреть удаление семафоров и разделяемой памяти по ее завершению любым из способов.*

    TBA

4. *Результаты работы программы должны быть отражены в отчете.*

    Пример работы:
    ```bash
    TBA
    ```

### 6 баллов 
### UNIX SYSTEM V

*В дополнение к программе на предыдущую оценку необходимо разработать программу, в которой для взаимодействия процессов используется один из двух вариантов, описанных выше, но не реализованных на предшествующую оценку.*

1. *Множество процессов взаимодействуют с использованием семафоров в стандарте UNIX SYSTEM V. Обмен данными ведется через разделяемую память в стандарте UNIX SYSTEM V.*

    TBA

2. *Реализовать завершение программы в соответствии с условием задачи, а также предусмотреть корректное завершение по прерыванию с клавиатуры по соответствующему сигналу.*

    TBA

3. *В программе предусмотреть удаление семафоров и разделяемой памяти по ее завершению любым из способов.*

    TBA

4. *Результаты работы программы должны быть отражены в отчете.*

    Пример работы:
    ```bash
    TBA
    ```

## Как запустить

На тестовом наборе:

```bash
make run
```

Перекомпилировать:

```bash
make compile
```

Удалить результаты тестов:

```bash
make clear
```
